---
title: "Boston Housing Analysis"
output: 
  flexdashboard::flex_dashboard:
    theme:
      bg: "#101010"
      fg: "#FDF7F7" 
      primary: "#ED79F9"
      base_font:
        google: Prompt
      code_font:
        google: JetBrains Mono
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
# Install thematic and un-comment for themed static plots (i.e., ggplot2)
# thematic::thematic_rmd()
library(shiny)
library(shinyWidgets)
library(shinyjs)

# Core
library(tidyverse)
library(tidyquant)

# Visualization
library(plotly)

# Modeling
library(parsnip)
library(xgboost)
library(cluster)
library(timetk)

# Database
library(odbc)
library(RSQLite)

con <- dbConnect(RSQLite::SQLite(), "00_data/database.sqlite")

#dbListTables(con)
# We now have a local data frame from database connection
df1 <- tbl(con, "house_tbl") %>%
  collect()
dbDisconnect(con)

# Scripts to call in once completed
# source("../00_scripts/02_process_data.R")
# source("../00_scripts/03_make_predictions.R")

# Models to call in once completed
# model_glm <- read_rds("../00_model/model_glm.rds")
# model_xgboost <- read_rds("../00_model/model_xgboost.rds")
# model_kmeans <- read_rds("00_model/model_kmeans.rds") 
```

Column {.sidebar}
-----------------------------------------------------------------------

```{r}
useShinyjs(rmd = TRUE)

# Selecting Neighborhood
pickerInput(inputId  = "picker_category_1", 
            label    = h4("Neighborhood"),
            choices  = sort(unique(df1$Neighborhood)), 
            selected = "Blmngtn")

br()
hr()
br()

pickerInput(inputId  = "picker_input_2", 
            label    = h4("Number of clusters:"), 
            choices  = c(3, 5, 7, 9, 11, 13, 15), 
            selected = 5)


actionButton(inputId = "apply", label = "Apply", icon = icon(name = "play", lib = "font-awesome"))

actionButton("reset", label = "Reset", icon = icon("sync"))

observeEvent(eventExpr = input$reset, handlerExpr = {
  
  updateTextInput(session = session, inputId = "picker_category_1", selected = "Blmngtn")
  
  updatePickerInput(session = session, inputId = "picker_category_2", selected = 5)

  delay(ms = 300, expr = {
    click(id = "apply")
  })
  
})
```

Column {data-width=650 .tabset}
-----------------------------------------------------------------------

### K-means Clustering

```{r}
# Define UI elements for k-means clustering
# new_cluster_tbl <- eventReactive(eventExpr = input$apply, valueExpr = {
#   
#   server_kmeans(
#     cluster_model = input$text_bike_model, 
#     category_1 = bike_type(), 
#     frame_material = input$picker_frame_material, 
#     .ml_model = model_xgboost)
#   
# }, ignoreNULL = FALSE)
```

### Generalized Linear Model (GLM)

```{r}

```

Column {data-width=350}
-----------------------------------------------------------------------

### Price Prediction

```{r}

```

### Accuracy

```{r}

```

